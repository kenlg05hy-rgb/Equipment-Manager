<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MedicalDeviceApp.MainPage">

    <ScrollView>
        <VerticalStackLayout Padding="20"
                             Spacing="15">

            <Label Text="🏥 App Quản Lý Thiết Bị"
                   FontSize="28"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   TextColor="#512BD4"/>

            <Frame BorderColor="Gray"
                   CornerRadius="10"
                   Padding="15"
                   BackgroundColor="#F0F9FF">
                <VerticalStackLayout Spacing="10">
                    <Label Text="📝 Thông Tin Chi Tiết Thiết Bị"
                           FontAttributes="Bold"
                           TextColor="#1565C0"
                           FontSize="16"/>

                    <Grid ColumnDefinitions="*,*"
                          RowDefinitions="Auto,Auto,Auto,Auto"
                          ColumnSpacing="10"
                          RowSpacing="10">

                        <Entry Grid.Row="0"
                               Grid.Column="0"
                               x:Name="TxtName"
                               Placeholder="Tên thiết bị *"
                               BackgroundColor="White"
                               TextColor="Black"/>
                        <Entry Grid.Row="0"
                               Grid.Column="1"
                               x:Name="TxtSerial"
                               Placeholder="Số Serial *"
                               BackgroundColor="White"
                               TextColor="Black"/>

                        <Entry Grid.Row="1"
                               Grid.Column="0"
                               x:Name="TxtModel"
                               Placeholder="Model/Ký hiệu"
                               BackgroundColor="White"
                               TextColor="Black"/>
                        <Entry Grid.Row="1"
                               Grid.Column="1"
                               x:Name="TxtOrigin"
                               Placeholder="Nước sản xuất"
                               BackgroundColor="White"
                               TextColor="Black"/>

                        <Entry Grid.Row="2"
                               Grid.Column="0"
                               x:Name="TxtPrice"
                               Placeholder="Nguyên giá (VNĐ)"
                               Keyboard="Numeric"
                               BackgroundColor="White"
                               TextColor="Black"/>
                        <Entry Grid.Row="2"
                               Grid.Column="1"
                               x:Name="TxtSupplier"
                               Placeholder="Nhà cung cấp"
                               BackgroundColor="White"
                               TextColor="Black"/>

                        <HorizontalStackLayout Grid.Row="3"
                                               Grid.Column="0"
                                               Spacing="5"
                                               VerticalOptions="Center">
                            <Label Text="Ngày mua:"
                                   VerticalOptions="Center"
                                   TextColor="Black"/>
                            <DatePicker x:Name="PickPurchaseDate"
                                        Format="dd/MM/yyyy"
                                        TextColor="Black"
                                        BackgroundColor="White"/>
                        </HorizontalStackLayout>

                        <Entry Grid.Row="3"
                               Grid.Column="1"
                               x:Name="TxtDepartment"
                               Placeholder="Khoa/Phòng sử dụng"
                               BackgroundColor="White"
                               TextColor="Black"/>
                    </Grid>

                    <Entry x:Name="TxtStatus"
                           Placeholder="Trạng thái hiện tại (VD: Tốt, Hỏng...)"
                           BackgroundColor="White"
                           TextColor="Black"/>

                    <Button x:Name="BtnSave"
                            Text="+ Lưu Hồ Sơ Thiết Bị"
                            Clicked="OnAddClicked"
                            BackgroundColor="#00C853"
                            TextColor="White"
                            FontAttributes="Bold"
                            CornerRadius="20"/>
                </VerticalStackLayout>
            </Frame>

            <Grid ColumnDefinitions="*, Auto"
                  Margin="0,5">
                <Button x:Name="LoadBtn"
                        Grid.Column="0"
                        Text="🔄 Tải Lại Danh Sách"
                        Clicked="OnLoadClicked"
                        BackgroundColor="#512BD4"
                        Margin="0,0,5,0"/>
            </Grid>

            <SearchBar x:Name="TxtSearch"
                       Placeholder="🔍 Tìm theo tên hoặc trạng thái..."
                       SearchButtonPressed="OnSearchPressed"
                       TextChanged="OnSearchTextChanged"
                       BackgroundColor="#F5F5F5"
                       TextColor="Black"/>

            <CollectionView Grid.Row="2"
                    x:Name="DeviceList">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame Margin="10,5"
                                Padding="10">
                            <Grid ColumnDefinitions="*, Auto, Auto, Auto">

                                <VerticalStackLayout Grid.Column="0"
                                        VerticalOptions="Center">
                                    <Label Text="{Binding DeviceName}"
                                            FontAttributes="Bold"
                                            FontSize="16"
                                            TextColor="Black"/>
                                    <Label Text="{Binding SerialNumber}"
                                            TextColor="Gray"/>
                                    <Label Text="{Binding Status}"
                                            TextColor="Blue"/>
                                </VerticalStackLayout>

                                <Button Grid.Column="1"
                                        Text="👁️"
                                        Clicked="OnDetailClicked"
                                        CommandParameter="{Binding .}"
                                        BackgroundColor="#2196F3"
                                        TextColor="White"
                                        WidthRequest="50"
                                        HeightRequest="40"
                                        Margin="5,0"/>

                                <Button Grid.Column="2"
                                        Text="✏️"
                                        Clicked="OnEditClicked"
                                        CommandParameter="{Binding .}"
                                        BackgroundColor="#FFC107"
                                        TextColor="Black"
                                        WidthRequest="50"
                                        HeightRequest="40"
                                        Margin="0,0,5,0"/>

                                <Button Grid.Column="3"
                                        Text="🗑️"
                                        Clicked="OnDeleteClicked"
                                        CommandParameter="{Binding DeviceID}"
                                        BackgroundColor="#FF5252"
                                        TextColor="White"
                                        WidthRequest="50"
                                        HeightRequest="40"/>
                            </Grid>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>